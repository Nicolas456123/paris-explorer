<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paris Explorer - DÃ©couvrez tous les trÃ©sors de Paris</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#D4AF37">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Paris Explorer">
    <link rel="manifest" href="manifest.json">
    
    <!-- CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
    <link rel="stylesheet" href="assets/css/themes.css">
    
    <!-- Preconnect pour optimiser le chargement -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container" id="appContainer">
        <!-- Header avec navigation -->
        <header class="header">
            <div class="header-content">
                <h1 class="app-title">ğŸ—¼ Paris Explorer</h1>
                <div class="header-actions">
                    <button class="btn-header" id="settingsBtn" title="ParamÃ¨tres">âš™ï¸</button>
                    <button class="btn-header" id="helpBtn" title="Aide">â“</button>
                </div>
            </div>
        </header>

        <!-- Section Navigation -->
        <nav class="nav-section">
            <div class="user-section">
                <label for="userSelect">ğŸ‘¤ Utilisateur :</label>
                <select id="userSelect" class="user-select">
                    <option value="">SÃ©lectionner...</option>
                </select>
                <button class="btn btn-sm" id="addUserBtn">+ Nouveau</button>
            </div>
        </nav>

        <!-- ContrÃ´les Recherche et Filtres -->
        <section class="controls-section">
            <div class="controls-container">
                <!-- Barre de recherche intelligente -->
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="ğŸ” Rechercher monuments, restaurants, cafÃ©s..." autocomplete="off">
                    <div class="search-suggestions" id="searchSuggestions"></div>
                </div>

                <!-- Filtres avancÃ©s -->
                <div class="filters-container">
                    <select id="arrondissementFilter" class="filter-select">
                        <option value="">ğŸ“ Tous les arrondissements</option>
                    </select>

                    <select id="categoryFilter" class="filter-select">
                        <option value="">ğŸ¯ Toutes les catÃ©gories</option>
                    </select>

                    <select id="statusFilter" class="filter-select">
                        <option value="">ğŸ“Š Statut</option>
                        <option value="visited">âœ… VisitÃ©s</option>
                        <option value="not-visited">â³ Ã€ visiter</option>
                        <option value="favorites">â­ Favoris</option>
                    </select>

                    <div class="view-controls">
                        <button class="btn-icon" id="resetFiltersBtn" title="RÃ©initialiser filtres">ğŸ”„</button>
                        <button class="btn-icon" id="viewModeBtn" title="Mode d'affichage">ğŸ“‹</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Onglets Navigation -->
        <nav class="tabs-navigation">
            <button class="tab-btn active" data-tab="list">ğŸ“‹ Liste</button>
            <button class="tab-btn" data-tab="map">ğŸ—ºï¸ Carte</button>
            <button class="tab-btn" data-tab="favorites">â­ Favoris</button>
            <button class="tab-btn" data-tab="collections">ğŸ“š Collections</button>
            <button class="tab-btn" data-tab="achievements">ğŸ† SuccÃ¨s</button>
            <button class="tab-btn" data-tab="stats">ğŸ“Š Stats</button>
        </nav>

        <!-- Contenu Principal -->
        <main class="main-content">
            <!-- Onglet Liste -->
            <div class="tab-content active" id="listTab">
                <div class="content-header">
                    <div class="progress-overview">
                        <div class="overall-stats">
                            <span class="stat-item">ğŸ“ <span id="totalPlaces">0</span> lieux</span>
                            <span class="stat-item">âœ… <span id="visitedPlaces">0</span> visitÃ©s</span>
                            <span class="stat-item">ğŸ“Š <span id="completionRate">0%</span></span>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="dataContainer" class="data-container">
                    <!-- Le contenu sera gÃ©nÃ©rÃ© par JavaScript -->
                </div>
            </div>
            
            <!-- Onglet Carte -->
            <div class="tab-content" id="mapTab">
                <div class="map-controls">
                    <div class="map-legend">
                        <span class="legend-item">âœ… <span style="color: #059669;">VisitÃ©</span></span>
                        <span class="legend-item">ğŸ“ <span style="color: #D4AF37;">Ã€ explorer</span></span>
                    </div>
                </div>
                <div id="mapContainer" class="map-container">
                    <!-- La carte Leaflet sera initialisÃ©e ici -->
                </div>
            </div>
            
            <!-- Onglet Favoris -->
            <div class="tab-content" id="favoritesTab">
                <div class="content-header">
                    <h2>â­ Mes Favoris</h2>
                    <div class="content-actions">
                        <button class="btn btn-primary" id="exportFavoritesBtn">ğŸ“¤ Exporter</button>
                        <button class="btn btn-secondary" id="clearFavoritesBtn">ğŸ—‘ï¸ Vider</button>
                    </div>
                </div>
                <div id="favoritesContainer" class="favorites-container">
                    <!-- Les favoris seront gÃ©nÃ©rÃ©s par JavaScript -->
                </div>
            </div>
            
            <!-- Onglet Collections -->
            <div class="tab-content" id="collectionsTab">
                <div class="content-header">
                    <h2>ğŸ“š Mes Collections</h2>
                    <div class="content-actions">
                        <button class="btn btn-primary" id="createCollectionBtn">+ Nouvelle Collection</button>
                        <button class="btn btn-secondary" id="importCollectionBtn">ğŸ“¥ Importer</button>
                    </div>
                </div>
                <div id="collectionsContainer" class="collections-container">
                    <!-- Les collections seront gÃ©nÃ©rÃ©es par JavaScript -->
                </div>
            </div>
            
            <!-- Onglet Achievements -->
            <div class="tab-content" id="achievementsTab">
                <div class="content-header">
                    <h2>ğŸ† SuccÃ¨s & RÃ©compenses</h2>
                    <div class="achievement-stats">
                        <span id="achievementProgress">0 / 42 succÃ¨s dÃ©bloquÃ©s</span>
                    </div>
                </div>
                <div id="achievementsContainer" class="achievements-container">
                    <!-- Les achievements seront gÃ©nÃ©rÃ©s par JavaScript -->
                </div>
            </div>
            
            <!-- Onglet Statistiques -->
            <div class="tab-content" id="statsTab">
                <div class="content-header">
                    <h2>ğŸ“Š Statistiques DÃ©taillÃ©es</h2>
                </div>
                <div id="statsContainer" class="stats-container">
                    <!-- Les statistiques seront gÃ©nÃ©rÃ©es par JavaScript -->
                </div>
            </div>
        </main>
    </div>
    
    <!-- Modals -->
    
    <!-- Modal Ajout Utilisateur -->
    <div class="modal" id="userModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ‘¤ Nouvel Utilisateur</h3>
                <button class="close-btn" id="closeUserModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="userForm">
                    <div class="form-group">
                        <label for="userName">Nom :</label>
                        <input type="text" id="userName" required maxlength="30" placeholder="Entrez le nom">
                    </div>
                    <div class="form-group">
                        <label for="userColor">Couleur :</label>
                        <select id="userColor">
                            <option value="#D4AF37">ğŸŸ¡ Or</option>
                            <option value="#059669">ğŸŸ¢ Vert</option>
                            <option value="#DC2626">ğŸ”´ Rouge</option>
                            <option value="#7C3AED">ğŸŸ£ Violet</option>
                            <option value="#EA580C">ğŸŸ  Orange</option>
                            <option value="#0891B2">ğŸ”µ Bleu</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="saveUserBtn">CrÃ©er</button>
                <button class="btn btn-secondary" id="cancelUserBtn">Annuler</button>
            </div>
        </div>
    </div>
    
    <!-- Modal ParamÃ¨tres -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">âš™ï¸ ParamÃ¨tres</h3>
                <button class="close-btn" id="closeSettingsBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h4>Affichage</h4>
                    <div class="setting-item">
                        <label for="themeSelect">ThÃ¨me :</label>
                        <select id="themeSelect">
                            <option value="default">ğŸŒŸ Parisien (dÃ©faut)</option>
                            <option value="dark">ğŸŒ™ Sombre</option>
                            <option value="light">â˜€ï¸ Clair</option>
                        </select>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h4>DonnÃ©es</h4>
                    <div class="setting-actions">
                        <button class="btn btn-primary" id="exportAllBtn">ğŸ“¤ Exporter toutes les donnÃ©es</button>
                        <button class="btn btn-secondary" id="importDataBtn">ğŸ“¥ Importer des donnÃ©es</button>
                        <button class="btn btn-danger" id="clearAllDataBtn">ğŸ—‘ï¸ Effacer toutes les donnÃ©es</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Collection -->
    <div class="modal" id="collectionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="collectionModalTitle">ğŸ“š Nouvelle Collection</h3>
                <button class="close-btn" id="closeCollectionModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="collectionForm">
                    <div class="form-group">
                        <label for="collectionName">Nom de la collection :</label>
                        <input type="text" id="collectionName" required placeholder="Mes restaurants favoris...">
                    </div>
                    <div class="form-group">
                        <label for="collectionDescription">Description :</label>
                        <textarea id="collectionDescription" placeholder="Description optionnelle..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="collectionColor">Couleur :</label>
                        <select id="collectionColor">
                            <option value="#D4AF37">ğŸŸ¡ Or</option>
                            <option value="#059669">ğŸŸ¢ Vert</option>
                            <option value="#DC2626">ğŸ”´ Rouge</option>
                            <option value="#7C3AED">ğŸŸ£ Violet</option>
                            <option value="#EA580C">ğŸŸ  Orange</option>
                            <option value="#0891B2">ğŸ”µ Bleu</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="saveCollectionBtn">Sauvegarder</button>
                <button class="btn btn-secondary" id="cancelCollectionBtn">Annuler</button>
            </div>
        </div>
    </div>
    
    <!-- Modal Notes -->
    <div class="modal" id="noteModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="noteModalTitle">ğŸ“ Notes</h3>
                <button class="close-btn" id="closeNoteModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="note-form">
                    <textarea id="noteTextarea" placeholder="Ajoutez vos notes, impressions, conseils..."></textarea>
                    <div class="form-actions">
                        <button class="btn btn-primary" id="saveNoteBtn">Sauvegarder</button>
                        <button class="btn btn-secondary" id="cancelNoteBtn">Annuler</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Details Lieu -->
    <div class="modal" id="placeModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 class="modal-title" id="placeModalTitle"></h3>
                <button class="close-btn" id="closePlaceModalBtn">&times;</button>
            </div>
            <div class="modal-body" id="placeModalContent">
                <!-- Contenu dÃ©taillÃ© du lieu -->
            </div>
        </div>
    </div>
    
    <!-- Toast Notifications Container -->
    <div class="notifications-container" id="notificationsContainer">
        <!-- Les notifications dynamiques apparaÃ®tront ici -->
    </div>
    
    <!-- Inputs cachÃ©s -->
    <input type="file" id="importFileInput" accept=".json" style="display: none;">
    
    <!-- Loading Spinner Global -->
    <div class="global-loading" id="globalLoading" style="display: none;">
        <div class="loading-spinner"></div>
        <p>Chargement...</p>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Modules JavaScript -->
    <script src="assets/js/utils.js"></script>
    <script src="assets/js/data-manager.js"></script>
    <script src="assets/js/user-manager.js"></script>
    <script src="assets/js/map-manager.js"></script>
    <script src="assets/js/ui-manager.js"></script>
    <script src="assets/js/search-filter.js"></script>
    <script src="assets/js/export-import.js"></script>
    <script src="assets/js/app.js"></script>
    
    <!-- Service Worker pour PWA -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(registrationError => console.log('SW registration failed'));
            });
        }
    </script>
</body>
</html>
