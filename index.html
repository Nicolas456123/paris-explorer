<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paris Explorer - D√©couvrez tous les tr√©sors de Paris</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#D4AF37">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Paris Explorer">
    <link rel="manifest" href="manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">
    <link rel="apple-touch-icon" href="assets/images/icon-192.png">
    
    <!-- CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
    <link rel="stylesheet" href="assets/css/themes.css">
    
    <!-- Preconnect pour optimiser le chargement -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container" id="appContainer">
        <!-- Header avec navigation -->
        <header class="header">
            <div class="header-content">
                <h1 class="app-title">üóº Paris Explorer</h1>
                <div class="header-actions">
                    <button class="btn-header" id="settingsBtn" title="Param√®tres">‚öôÔ∏è</button>
                    <button class="btn-header" id="helpBtn" title="Aide">‚ùì</button>
                </div>
            </div>
        </header>

        <!-- Section Navigation -->
        <nav class="nav-section">
            <div class="user-section">
                <label for="userSelect">üë§ Utilisateur :</label>
                <select id="userSelect" class="user-select">
                    <option value="">S√©lectionner...</option>
                </select>
                <button class="btn btn-sm" id="addUserBtn">+ Nouveau</button>
                <button class="btn btn-sm" id="manageUsersBtn">G√©rer</button>
            </div>
            
            <!-- Barre de recherche avanc√©e -->
            <div class="search-section">
                <div class="search-container">
                    <input type="text" id="searchInput" class="search-input" placeholder="üîç Rechercher un lieu, monument, restaurant...">
                    <button class="search-btn" id="searchBtn">üîç</button>
                    <button class="voice-search-btn" id="voiceSearchBtn" title="Recherche vocale">üé§</button>
                </div>
                
                <!-- Filtres avanc√©s -->
                <div class="filters-container">
                    <select id="arrondissementFilter" class="filter-select">
                        <option value="">Tous les arrondissements</option>
                    </select>
                    <select id="categoryFilter" class="filter-select">
                        <option value="">Toutes les cat√©gories</option>
                    </select>
                    <select id="statusFilter" class="filter-select">
                        <option value="">Tous les statuts</option>
                        <option value="visited">Visit√©s</option>
                        <option value="not-visited">Non visit√©s</option>
                        <option value="favorites">Favoris</option>
                    </select>
                    
                    <div class="filter-actions">
                        <label class="checkbox-label">
                            <input type="checkbox" id="hideCompletedFilter">
                            Masquer les visit√©s
                        </label>
                        <button class="btn btn-sm" id="clearFiltersBtn">Effacer</button>
                    </div>
                </div>
            </div>
            
            <!-- Onglets de navigation -->
            <div class="tabs-container">
                <button class="tab-btn active" data-tab="list">üìã Liste</button>
                <button class="tab-btn" data-tab="map">üó∫Ô∏è Carte</button>
                <button class="tab-btn" data-tab="favorites">‚≠ê Favoris</button>
                <button class="tab-btn" data-tab="collections">üìö Collections</button>
                <button class="tab-btn" data-tab="achievements">üèÜ Succ√®s</button>
                <button class="tab-btn" data-tab="stats">üìä Statistiques</button>
            </div>
        </nav>

        <!-- Zone de contenu principal -->
        <main class="main-content" id="mainContent">
            <!-- Onglet Liste -->
            <div class="tab-content active" id="listTab">
                <div class="content-header">
                    <h2>üìã Lieux de Paris</h2>
                    <div class="content-actions">
                        <div class="view-controls">
                            <button class="btn-icon" id="listViewBtn" title="Vue liste">üìã</button>
                            <button class="btn-icon" id="gridViewBtn" title="Vue grille">‚ñ¶</button>
                            <button class="btn-icon" id="compactViewBtn" title="Vue compacte">‚ò∞</button>
                        </div>
                        <div class="sort-controls">
                            <select id="sortSelect" class="sort-select">
                                <option value="default">Tri par d√©faut</option>
                                <option value="alphabetical">Alphab√©tique</option>
                                <option value="completion">Par progression</option>
                                <option value="category">Par cat√©gorie</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div id="placesContainer" class="places-container">
                    <!-- Le contenu sera g√©n√©r√© par JavaScript -->
                </div>
            </div>
            
            <!-- Onglet Carte -->
            <div class="tab-content" id="mapTab">
                <div class="content-header">
                    <h2>üó∫Ô∏è Carte Interactive</h2>
                    <div class="map-controls">
                        <button class="map-control-btn" id="centerMapBtn" title="Centrer sur Paris">üéØ</button>
                        <button class="map-control-btn" id="fullscreenMapBtn" title="Plein √©cran">‚õ∂</button>
                        <button class="map-control-btn" id="layersBtn" title="Couches">üóÇÔ∏è</button>
                    </div>
                </div>
                <div id="mapContainer" class="map-container">
                    <!-- La carte Leaflet sera initialis√©e ici -->
                </div>
            </div>
            
            <!-- Onglet Favoris -->
            <div class="tab-content" id="favoritesTab">
                <div class="content-header">
                    <h2>‚≠ê Mes Favoris</h2>
                    <div class="content-actions">
                        <button class="btn btn-primary" id="exportFavoritesBtn">üì§ Exporter</button>
                        <button class="btn btn-secondary" id="clearFavoritesBtn">üóëÔ∏è Vider</button>
                    </div>
                </div>
                <div id="favoritesContainer" class="favorites-container">
                    <!-- Les favoris seront g√©n√©r√©s par JavaScript -->
                </div>
            </div>
            
            <!-- Onglet Collections -->
            <div class="tab-content" id="collectionsTab">
                <div class="content-header">
                    <h2>üìö Mes Collections</h2>
                    <div class="content-actions">
                        <button class="btn btn-primary" id="createCollectionBtn">+ Nouvelle Collection</button>
                        <button class="btn btn-secondary" id="importCollectionBtn">üì• Importer</button>
                    </div>
                </div>
                <div id="collectionsContainer" class="collections-container">
                    <!-- Les collections seront g√©n√©r√©es par JavaScript -->
                </div>
            </div>
            
            <!-- Onglet Achievements -->
            <div class="tab-content" id="achievementsTab">
                <div class="content-header">
                    <h2>üèÜ Succ√®s & R√©compenses</h2>
                    <div class="achievement-stats">
                        <span id="achievementProgress">0 / 42 succ√®s d√©bloqu√©s</span>
                    </div>
                </div>
                <div id="achievementsContainer" class="achievements-container">
                    <!-- Les achievements seront g√©n√©r√©s par JavaScript -->
                </div>
            </div>
            
            <!-- Onglet Statistiques -->
            <div class="tab-content" id="statsTab">
                <div class="content-header">
                    <h2>üìä Mes Statistiques</h2>
                    <div class="content-actions">
                        <button class="btn btn-secondary" id="exportStatsBtn">üì§ Exporter</button>
                        <button class="btn btn-secondary" id="resetStatsBtn">üîÑ Reset</button>
                    </div>
                </div>
                <div id="statsContainer" class="stats-container">
                    <!-- Les statistiques seront g√©n√©r√©es par JavaScript -->
                </div>
            </div>
        </main>
    </div>
    
    <!-- Modal Ajouter Utilisateur -->
    <div class="modal" id="addUserModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üë§ Nouvel Utilisateur</h3>
                <button class="close-btn" id="closeAddUserModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="newUserName">Nom d'utilisateur :</label>
                    <input type="text" id="newUserName" class="form-input" placeholder="Entrez votre nom" maxlength="30">
                </div>
                <div class="form-actions">
                    <button class="btn btn-primary" id="createUserBtn">Cr√©er</button>
                    <button class="btn btn-secondary" id="cancelCreateUserBtn">Annuler</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal G√©rer Utilisateurs -->
    <div class="modal" id="manageUsersModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 class="modal-title">üë• Gestion des Utilisateurs</h3>
                <button class="close-btn" id="closeManageUsersModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="user-management">
                    <div class="user-list" id="userList">
                        <!-- La liste des utilisateurs sera g√©n√©r√©e ici -->
                    </div>
                    
                    <div class="management-actions">
                        <div class="export-section">
                            <h4>üì§ Exporter</h4>
                            <div class="export-options">
                                <button class="btn btn-primary" onclick="app.exportImport.exportUserData('json')">JSON</button>
                                <button class="btn btn-primary" onclick="app.exportImport.exportUserData('csv')">CSV</button>
                                <button class="btn btn-primary" onclick="app.exportImport.exportUserData('pdf')">PDF</button>
                                <button class="btn btn-primary" onclick="app.exportImport.exportCompleteUserData()">Tout</button>
                            </div>
                        </div>
                        
                        <div class="import-section">
                            <h4>üì• Importer</h4>
                            <div class="import-area">
                                <button class="btn btn-primary" onclick="document.getElementById('importFileInput').click()">
                                    S√©lectionner fichier JSON
                                </button>
                                <p class="import-info">
                                    Formats support√©s : progression, favoris, notes, collections ou donn√©es compl√®tes
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Param√®tres -->
    <div class="modal" id="settingsModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 class="modal-title">‚öôÔ∏è Param√®tres Avanc√©s</h3>
                <button class="close-btn" id="closeSettingsModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div id="settingsContainer">
                    <!-- Les param√®tres seront rendus ici -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Collection -->
    <div class="modal" id="collectionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="collectionModalTitle">üìö Nouvelle Collection</h3>
                <button class="close-btn" id="closeCollectionModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="collectionName">Nom de la collection :</label>
                    <input type="text" id="collectionName" class="form-input" placeholder="Ex: Mes restaurants favoris">
                </div>
                <div class="form-group">
                    <label for="collectionDescription">Description :</label>
                    <textarea id="collectionDescription" class="form-textarea" placeholder="D√©crivez votre collection..."></textarea>
                </div>
                <div class="form-actions">
                    <button class="btn btn-primary" id="saveCollectionBtn">Sauvegarder</button>
                    <button class="btn btn-secondary" id="cancelCollectionBtn">Annuler</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Note -->
    <div class="modal" id="noteModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="noteModalTitle">üìù Ajouter une Note</h3>
                <button class="close-btn" id="closeNoteModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="noteContent">Note personnelle :</label>
                    <textarea id="noteContent" class="form-textarea" placeholder="Partagez votre exp√©rience, vos conseils..."></textarea>
                </div>
                <div class="form-group">
                    <label for="noteRating">√âvaluation :</label>
                    <div class="rating-input" id="noteRating">
                        <button class="star-btn" data-rating="1">‚≠ê</button>
                        <button class="star-btn" data-rating="2">‚≠ê</button>
                        <button class="star-btn" data-rating="3">‚≠ê</button>
                        <button class="star-btn" data-rating="4">‚≠ê</button>
                        <button class="star-btn" data-rating="5">‚≠ê</button>
                    </div>
                </div>
                <div class="form-actions">
                    <button class="btn btn-primary" id="saveNoteBtn">Sauvegarder</button>
                    <button class="btn btn-secondary" id="cancelNoteBtn">Annuler</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Details Lieu -->
    <div class="modal" id="placeModal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 class="modal-title" id="placeModalTitle"></h3>
                <button class="close-btn" id="closePlaceModalBtn">&times;</button>
            </div>
            <div class="modal-body" id="placeModalContent">
                <!-- Contenu d√©taill√© du lieu -->
            </div>
        </div>
    </div>
    
    <!-- Toast Notifications Container -->
    <div class="notifications-container" id="notificationsContainer">
        <!-- Les notifications dynamiques appara√Ætront ici -->
    </div>
    
    <!-- Inputs cach√©s -->
    <input type="file" id="importFileInput" accept=".json" style="display: none;">
    
    <!-- Loading Spinner Global -->
    <div class="global-loading" id="globalLoading" style="display: none;">
        <div class="loading-spinner"></div>
        <p>Chargement...</p>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Modules JavaScript (NOMS CORRIGES) -->
    <script src="assets/js/utils.js"></script>
    <script src="assets/js/data-manager.js"></script>
    <script src="assets/js/user-manager.js"></script>
    <script src="assets/js/map-manager.js"></script>
    <script src="assets/js/ui-manager.js"></script>
    <script src="assets/js/search-filter.js"></script>
    <script src="assets/js/export-import.js"></script>
    <script src="assets/js/app.js"></script>
    
    <!-- Service Worker pour PWA (√Ä LA RACINE) -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(registrationError => console.log('SW registration failed'));
            });
        }
    </script>
</body>
</html>
